-- ================================================================
-- 報酬率を20%に修正するスクリプト
-- ================================================================
--
-- 既にservicesテーブルが存在し、間違った報酬率が設定されている場合、
-- このスクリプトを実行してください。
--
-- ================================================================

-- 1. 全サービスの報酬率を20%に統一
UPDATE services
SET
    default_commission_rate = 20.00,  -- 粗利の20%
    default_referral_rate = 0.00,
    updated_at = NOW()
WHERE status = 'active';

-- 2. 確認
SELECT
    name,
    default_commission_rate as "報酬率(%)",
    default_referral_rate as "紹介率(%)",
    subscription_price as "月額料金(円)",
    status as "ステータス"
FROM services
ORDER BY name;

-- ================================================================
-- 期待される結果:
-- ================================================================
--
-- | name        | 報酬率(%) | 紹介率(%) | 月額料金(円) | ステータス |
-- |-------------|----------|----------|------------|---------|
-- | TaskMate AI | 20.00    | 0.00     | 2980       | active  |
-- | LiteWEB+    | 20.00    | 0.00     | 4980       | active  |
--
-- ================================================================
